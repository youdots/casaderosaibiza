<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Impressions</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

      :root {
        --cdr-bg: #e2d9d5;
        --cdr-text: #a0471a;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        background: var(--cdr-bg);
        font-family: "Inter", sans-serif;
        color: var(--cdr-text);
      }

      #ft-insta-brd {
        margin: 0 !important;
        padding: 0 !important;
      }
    </style>
  </head>
  <body>
    <div id="ft-insta-app"></div>
    <script type="module">
      import App from "https://cdn.fouita.com/public/instagram-feed.js?11";
      const rootStyles = getComputedStyle(document.documentElement);
      const bgColor = rootStyles.getPropertyValue("--cdr-bg").trim();
      const textColor = rootStyles.getPropertyValue("--cdr-text").trim();
      new App({
        target: document.getElementById("ft-insta-app"),
        props: {
          settings: {
            layout: "grid",
            source: "insta",
            selected: "uname",
            header: true,
            autoplay: false,
            zigzag: false,
            cols: 6,
            cardHeight: 250,
            gap: 15,
            direction: "down",
            height: 700,
            bgColor,
            txtColor: textColor,
            ukey: "e3b1eac8-5e34-4219-be80-238c176faad0",
          },
        },
      });
    </script>
    <div id="ft-insta-brd">
      <script src="https://cdn.commoninja.com/sdk/latest/commonninja.js" defer></script>
      <div class="commonninja_component pid-c9570fd1-c5cc-4cc9-893e-1fbffbb92d2c"></div>
    </div>
    <script>
      (() => {
        const rootStyles = getComputedStyle(document.documentElement);
        const BG_COLOR = rootStyles.getPropertyValue("--cdr-bg").trim();
        const TEXT_COLOR = rootStyles.getPropertyValue("--cdr-text").trim();
        const OVERRIDE_STYLE_ID = "impressions-overrides";
        const SHADOW_OVERRIDE_STYLE_ID = "impressions-overrides-shadow";
        const OVERRIDE_CSS = `
:root {
  --cdr-bg: ${BG_COLOR};
  --cdr-text: ${TEXT_COLOR};
}
html,
body {
  margin: 0;
  padding: 0;
  background: var(--cdr-bg) !important;
  color: var(--cdr-text) !important;
  font-family: "Inter", sans-serif !important;
}
#ft-insta-brd {
  margin: 0 !important;
  padding: 0 !important;
}
#ft-insta-app,
#ft-insta-brd,
.commonninja_component {
  background: var(--cdr-bg) !important;
  background-color: var(--cdr-bg) !important;
  color: var(--cdr-text) !important;
}
.ft-sff,
.ft-sff * {
  font-family: "Inter", sans-serif !important;
  color: var(--cdr-text) !important;
}
.ft-header,
.feed-header {
  background: var(--cdr-bg) !important;
  background-color: var(--cdr-bg) !important;
}
.ft-header-button,
.ft-header-button * {
  color: var(--cdr-text) !important;
  border-color: var(--cdr-text) !important;
  background: transparent !important;
  background-color: transparent !important;
}
.follow-button,
.follow-button {
  color: var(--cdr-text) !important;
  border: 1px solid var(--cdr-text) !important;
  background: transparent !important;
  background-color: transparent !important;
  -webkit-text-fill-color: var(--cdr-text) !important;
}
.follow-button * {
  color: var(--cdr-text) !important;
  -webkit-text-fill-color: var(--cdr-text) !important;
  border: 0 !important;
  outline: 0 !important;
}
.feed-content-social-share {
  display: none !important;
}
.feed-content-activity {
  font-size: 1.1em !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
}
.feed-content-activity svg {
  width: 1.1em !important;
  height: 1.1em !important;
}
.commonninja-ribbon,
[class*="commonninja-ribbon"] {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  pointer-events: none !important;
  height: 0 !important;
}
.grid-layout {
  gap: 15px !important;
  margin: 0 15px !important;
}
        `;
        const SHADOW_OVERRIDE_CSS = `
:host {
  --cdr-bg: ${BG_COLOR};
  --cdr-text: ${TEXT_COLOR};
  background: var(--cdr-bg) !important;
  background-color: var(--cdr-bg) !important;
  color: var(--cdr-text) !important;
  font-family: "Inter", sans-serif !important;
}
:host * {
  font-family: "Inter", sans-serif !important;
  color: var(--cdr-text) !important;
}
.ft-header,
.feed-header {
  background: var(--cdr-bg) !important;
  background-color: var(--cdr-bg) !important;
}
.feed-content-item,
.feed-content-item article {
  background: var(--cdr-bg) !important;
  background-color: var(--cdr-bg) !important;
}
.feed-content-item article * {
  background: transparent !important;
  background-color: transparent !important;
}
.feed-follow-button,
.feed-follow-button *,
.ft-header-button,
.ft-header-button *,
button,
[role="button"] {
  color: var(--cdr-text) !important;
  border-color: var(--cdr-text) !important;
  background: transparent !important;
  background-color: transparent !important;
}
.follow-button,
.follow-button {
  color: var(--cdr-text) !important;
  border: 1px solid var(--cdr-text) !important;
  background: transparent !important;
  background-color: transparent !important;
  -webkit-text-fill-color: var(--cdr-text) !important;
}
.follow-button * {
  color: var(--cdr-text) !important;
  -webkit-text-fill-color: var(--cdr-text) !important;
  border: 0 !important;
  outline: 0 !important;
}
.feed-content-social-share,
.feed-content-social-share *,
.feed-content-activity,
.feed-content-activity * {
  color: var(--cdr-text) !important;
  fill: var(--cdr-text) !important;
  stroke: var(--cdr-text) !important;
}
.feed-content-social-share {
  display: none !important;
}
.feed-content-activity {
  font-size: 1.1em !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
}
.feed-content-activity svg {
  width: 1.1em !important;
  height: 1.1em !important;
}
.commonninja-ribbon,
[class*="commonninja-ribbon"] {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  pointer-events: none !important;
  height: 0 !important;
}
.grid-layout {
  gap: 15px !important;
  margin: 0 15px !important;
}
        `;

        const ensureOverrideStyle = () => {
          let style = document.getElementById(OVERRIDE_STYLE_ID);
          if (!style) {
            style = document.createElement("style");
            style.id = OVERRIDE_STYLE_ID;
            style.textContent = OVERRIDE_CSS;
          } else if (style.textContent !== OVERRIDE_CSS) {
            style.textContent = OVERRIDE_CSS;
          }

          const head = document.head || document.documentElement;
          const anchor = document.getElementById("ft-fsocial-style");
          if (anchor && anchor.parentNode) {
            if (anchor.nextSibling !== style) {
              if (style.parentNode) {
                style.parentNode.removeChild(style);
              }
              anchor.parentNode.insertBefore(style, anchor.nextSibling);
            }
          } else if (!style.parentNode) {
            head.appendChild(style);
          } else if (style.parentNode === head && head.lastChild !== style) {
            head.appendChild(style);
          }
        };

        const ensureShadowOverrideStyle = (shadowRoot) => {
          if (!shadowRoot) {
            return;
          }
          let style = shadowRoot.querySelector(`#${SHADOW_OVERRIDE_STYLE_ID}`);
          if (!style) {
            style = document.createElement("style");
            style.id = SHADOW_OVERRIDE_STYLE_ID;
            style.textContent = SHADOW_OVERRIDE_CSS;
            shadowRoot.appendChild(style);
          } else if (style.textContent !== SHADOW_OVERRIDE_CSS) {
            style.textContent = SHADOW_OVERRIDE_CSS;
          }
        };

        const applyOverrides = () => {
          ensureOverrideStyle();
          const ribbons = document.querySelectorAll(
            ".commonninja-ribbon, [class*=\"commonninja-ribbon\"]"
          );
          for (const el of ribbons) {
            el.style.setProperty("display", "none", "important");
            el.style.setProperty("visibility", "hidden", "important");
            el.style.setProperty("opacity", "0", "important");
            el.style.setProperty("pointer-events", "none", "important");
          }

          const adjustSocialRow = (root) => {
            if (!root || typeof root.querySelectorAll !== "function") return;
            const shareButtons = root.querySelectorAll(".feed-content-social-share");
            for (const button of shareButtons) {
              button.style.setProperty("display", "none", "important");
              const row = button.parentElement;
              if (!row) continue;
              row.style.setProperty("justify-content", "center", "important");
              row.style.setProperty("align-items", "center", "important");
              row.style.setProperty("text-align", "center", "important");
            }

            const activityItems = root.querySelectorAll(".feed-content-activity");
            for (const activity of activityItems) {
              const row = activity.parentElement;
              if (!row) continue;
              row.style.setProperty("justify-content", "center", "important");
              row.style.setProperty("align-items", "center", "important");
              row.style.setProperty("text-align", "center", "important");
            }
          };

          adjustSocialRow(document);

          const components = document.querySelectorAll(".commonninja_component");
          for (const component of components) {
            ensureShadowOverrideStyle(component.shadowRoot);
            if (!component.shadowRoot) {
              continue;
            }

            const shadowRibbons = component.shadowRoot.querySelectorAll(
              ".commonninja-ribbon, [class*=\"commonninja-ribbon\"]"
            );
            for (const el of shadowRibbons) {
              el.style.setProperty("display", "none", "important");
              el.style.setProperty("visibility", "hidden", "important");
              el.style.setProperty("opacity", "0", "important");
              el.style.setProperty("pointer-events", "none", "important");
            }

            const shadowHeaders = component.shadowRoot.querySelectorAll(".feed-header");
            for (const el of shadowHeaders) {
              el.style.setProperty("background", BG_COLOR, "important");
              el.style.setProperty("background-color", BG_COLOR, "important");
            }

            const shadowTiles = component.shadowRoot.querySelectorAll(
              ".feed-content-item, .feed-content-item article"
            );
            for (const el of shadowTiles) {
              el.style.setProperty("background", BG_COLOR, "important");
              el.style.setProperty("background-color", BG_COLOR, "important");
            }

            const shadowFollowButtons = component.shadowRoot.querySelectorAll(
              ".feed-follow-button, .feed-follow-button *, " +
                ".ft-header-button, .ft-header-button *"
            );
            for (const el of shadowFollowButtons) {
              el.style.setProperty("color", TEXT_COLOR, "important");
              el.style.setProperty("border-color", TEXT_COLOR, "important");
              el.style.setProperty("background", "transparent", "important");
              el.style.setProperty("background-color", "transparent", "important");
            }

            adjustSocialRow(component.shadowRoot);
          }
        };

        const observer = new MutationObserver(applyOverrides);
        observer.observe(document.documentElement, { childList: true, subtree: true });
        window.addEventListener("load", applyOverrides);
        applyOverrides();

        let tries = 0;
        const interval = setInterval(() => {
          applyOverrides();
          tries += 1;
          if (tries >= 12) {
            clearInterval(interval);
          }
        }, 500);

        const READY_MESSAGE = { type: "cdr-impressions-ready" };
        const READY_REQUEST_TYPE = "cdr-impressions-request-ready";
        let impressionsReady = false;
        const trackedImages = new WeakSet();
        const trackedVideos = new WeakSet();
        const trackedBackgrounds = new Set();
        const observedRoots = new WeakSet();
        const readyObservers = [];

        const notifyReady = () => {
          if (!window.parent) return;
          try {
            window.parent.postMessage(READY_MESSAGE, window.location.origin);
          } catch {
            // ignore postMessage failures
          }
        };

        const markReady = () => {
          if (impressionsReady) return;
          impressionsReady = true;
          for (const observer of readyObservers) {
            observer.disconnect();
          }
          notifyReady();
        };

        const watchImage = (img) => {
          if (!img || trackedImages.has(img)) return;
          trackedImages.add(img);
          if (img.complete && img.naturalWidth > 0) {
            markReady();
            return;
          }
          img.addEventListener("load", markReady, { once: true });
        };

        const watchVideo = (video) => {
          if (!video || trackedVideos.has(video)) return;
          trackedVideos.add(video);
          if (video.readyState >= 2) {
            markReady();
            return;
          }
          video.addEventListener("loadeddata", markReady, { once: true });
        };

        const watchBackground = (url) => {
          if (!url || trackedBackgrounds.has(url)) return;
          trackedBackgrounds.add(url);
          const image = new Image();
          image.addEventListener("load", markReady, { once: true });
          image.src = url;
        };

        const scanForMedia = (root) => {
          if (impressionsReady) return;
          if (!root || typeof root.querySelectorAll !== "function") return;
          const images = root.querySelectorAll("img");
          for (const img of images) {
            watchImage(img);
            if (impressionsReady) return;
          }
          const videos = root.querySelectorAll("video");
          for (const video of videos) {
            watchVideo(video);
            if (impressionsReady) return;
          }
          const bgCandidates = root.querySelectorAll('[style*="background-image"]');
          for (const el of bgCandidates) {
            const bg = window.getComputedStyle(el).backgroundImage;
            if (!bg || bg === "none" || bg.includes("gradient")) continue;
            const match = bg.match(/url\((['"]?)(.*?)\1\)/i);
            if (match && match[2]) {
              watchBackground(match[2]);
              if (impressionsReady) return;
            }
          }
        };

        const ensureShadowObservers = (root) => {
          if (!root || typeof root.querySelectorAll !== "function") return;
          const components = root.querySelectorAll(".commonninja_component");
          for (const component of components) {
            if (component.shadowRoot) {
              observeRoot(component.shadowRoot);
            }
          }
        };

        const observeRoot = (root) => {
          if (!root || observedRoots.has(root)) return;
          observedRoots.add(root);
          const observer = new MutationObserver(() => {
            if (impressionsReady) return;
            scanForMedia(root);
            ensureShadowObservers(root);
          });
          observer.observe(root, { childList: true, subtree: true });
          readyObservers.push(observer);
          scanForMedia(root);
          ensureShadowObservers(root);
        };

        observeRoot(document.documentElement);
        window.addEventListener("load", () => {
          scanForMedia(document.documentElement);
          ensureShadowObservers(document.documentElement);
        });

        window.addEventListener("message", (event) => {
          if (event.origin !== window.location.origin) return;
          if (!event.data || event.data.type !== READY_REQUEST_TYPE) return;
          if (impressionsReady) {
            notifyReady();
            return;
          }
          scanForMedia(document.documentElement);
        });
      })();
    </script>
  </body>
</html>
